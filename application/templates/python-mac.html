{% extends "base.html" %}
{% import "macros.html" as macros %}
{% import "codemacros.html" as codemacros %} 
{% import "pythonTutorialMacros.html" as pythonmacros %}
{% block tutorialcontent %}
               
<h2>Create Python apps using SQL Server on a Mac</h2>
{{macros.introSentence("Python","Mac")}}
<ol>
    <li>
        <div class="step-item">
            <span>1</span>
        </div>
        <div class="step-body">
            <div tabindex="1" class="step-header collapsible">
                <h3>Set up your environment 
                    <span class="expand-icon">+</span>
                </h3>
                <p class="step-preview">In this section, you will get SQL Server vNext running on Docker. 
                    <span class="see-more">... 
                        <strong>See more</strong>
                    </span>
                    <span class="preview-content">After that you will install the necessary dependencies to run Python through Brew, and finally get command line tools for SQL Server.</span>
                </p>
            </div>
            <span class="step-content">
                <!--install SQL Server on Mac-->
                                {{macros.installSQLServerOnMac()}}
                                
                <h4>Install Homebrew and Python 2.7</h4>
                <p> If you already have Python and Homebrew installed on your machine, skip this step. Install Homebrew and Python using the following commands. Once you have installed Homebrew, make sure to restart the terminal session. </p>
                <pre class="command-line" data-prompt="$">
                    <code class="language-terminal">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code>
                </pre>
                <p>For Homebrew to work, you now need to 
                    <strong>restart the terminal session</strong> by closing and opening the terminal. Once you have opened a new session, use the following commands to install Python:
                </p>
                <pre data-output="2-100" class="command-line" data-prompt="$">
                    <code class="language-terminal">brew install python</code>
                </pre>
                <pre>
                    <code class="language-results"> 
==> Downloading https://homebrew.bintray.com/bottles/python-2.7.12.el_capitan.bottle.tar.gz

...

==> Caveats
Pip and setuptools have been installed. To update them
  pip install --upgrade pip setuptools

You can install Python packages with
  pip install

==> Summary
üç∫  /usr/local/Cellar/python/2.7.12: 3,476 files, 46.7M
                        </code>
                    </pre>
                    <p> Installing Python packages by default enables you to access the package functionality 'globally', across all projects on your system. This is pretty convenient, but sometimes you may want to use different versions of your Python package for different projects. <a href="https://virtualenv.pypa.io/en/stable/">Virutalenv</a> enables you to create virtual environments to isolate package installations between projects. Run the line below to install virtualenv: </p>
                    <pre data-output="2-100" class="command-line" data-prompt="$">
                        <code class="language-terminal">pip install virtualenv</code>
                    </pre>
                    <p>
                        <img src="https://deve2e.azureedge.net/sqlchoice/static/images/completeStar.png" alt="goldstar" style="width:25px;height:25px;"> You now have Python installed! The next section will walk you through getting the tools to interact with your database.
                        </p>
                        <h4>Install the Microsoft ODBC Driver for Mac</h4>
                            <pre class="command-line" data-prompt="$">
                                <code class="language-terminal">brew tap microsoft/msodbcsql https://github.com/Microsoft/homebrew-msodbcsql-preview
brew update
ACCEPT_EULA=y brew install msodbcsql
</code> </pre>
                            <h4>Install sql-cli - A Node.js Command Line Utility for SQL Server</h4>
                            <p>sql-cli is a command line tool that enables you to connect to SQL Server and run queries.</p>
                       

                            <pre data-output="3-6" class="command-line" data-prompt="$"><code class="language-terminal">brew install node
npm install -g sql-cli</code> </pre>
                            <p>Start the sql-cli utility by using the mssql command, and connect to SQL Server. Don't forget to provide the password you have set for your SQL Server login.</p>
                            <pre data-output="2-11" class="command-line" data-prompt="$">
                                <code class="language-terminal">mssql -s localhost -u sa -p your_password</code>
                            </pre>
                            <p>Run a basic query.</p>
                            <pre data-output="2-11" class="command-line" data-prompt="mssql>">
                                <code class="language-terminal">SELECT @@version </code>
                            </pre>
                            <pre>
                                <code class="language-results"> 
--------------------------------------------------------
Microsoft SQL Server - 13.0.2990.28 (x64)
    October 09 2016 17:45:12
    Copyright (c) Microsoft Corporation
    on Linux (Ubuntu 16.04)

1 rows(s) returned

</code>
                            </pre>
                            <p>Great! You just installed SQL Server on your Mac and ran your first query against it :-)
                                <br>Now exit sql-cli using the following command:
                            </p>
                            <pre data-output="2-11" class="command-line" data-prompt="$">
                                <code class="language-terminal">exit</code>
                            </pre>
                            <p>
                                <img src="https://deve2e.azureedge.net/sqlchoice/static/images/completeStar.png" alt="goldstar" style="width:25px;height:25px;">You can now interact with the database with queries using this CLI tool! This is great for short queries and small returned result sets. To work with larger result sets, check out the <a href="#resources"> mssql extension for VS Code!</a>
                                </p>
                            </span>
                        </div>
                    </li>
                    <!-- SECTION 2 START: CRUD and set up with Django -->
                    <!-- Look into pythonTutorialsMacros for pythonApps(platform, terminalprompt, cliTool, cliCommand)-->
                            {{pythonmacros.pythonApps("{ODBC Driver 13 for SQL Server}", "Mac", "$", "mssql", "mssql -s localhost -u sa -p your_password -q", "source venv/bin/activate", "'driver': 'ODBC Driver 13 for SQL Server',
            'host_is_server': True'"
)}} 
    
                    <!-- SECTION 2 END -->
                    <!-- SECTION 3 START: make python apps faster with columnstore-->
                    <!-- Look into pythonTutorialsMacros pythonColumnStore(driver, terminalprompt, cliTool, cliReadFileCommand, cliQueryCommand, virtualenvactivate)-->
                            {{pythonmacros.pythonColumnStore("{ODBC Driver 13 for SQL Server}", "$", "mssql", "mssql -s localhost -u sa -p your_password -d SampleDB ", "mssql -s localhost -u sa -p your_password -d SampleDB -q", "source venv/bin/activate")}} 
    
                    <!-- END SECTION 3-->
                   <li>
                        <div class="step-item" id="resources">
                            <span>+</span>
                        </div>
                        <div class="step-body">
                            {{macros.installVSCodeExtension()}}   
                        </div>
                    </li>      
                    <li>
                        <div class="step-body">
                        {{macros.CTA("https://channel9.msdn.com/Events/Connect/2016/189", "SQL Server + Python on Channel 9","https://docs.microsoft.com/en-us/sql/linux/")}}
                        </div>
                    </li>
                    <li>
                        <div class="step-item-tools"></div>
                        <div class="step-body">
                            {{macros.feedback()}}
                        </div>
                    </li>
                </ol>
                {{codemacros.discus()}}
{% endblock %}